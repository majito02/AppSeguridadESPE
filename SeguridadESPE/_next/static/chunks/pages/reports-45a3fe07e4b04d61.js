(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53],{9702:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports",function(){return t(3973)}])},3973:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return f}});var s=t(5893),l=t(7294),r=t(5152),o=t.n(r),n=t(9921),i=t(3345).Z,d=t(6800),c=t(4778),h=t(720),u=t(3599),m=t(2568),p=t(5679),x=t(3148);t(585);var b=t(6154),g=t(286);let w=o()(()=>Promise.all([t.e(279),t.e(388)]).then(t.bind(t,7229)),{loadableGenerated:{webpack:()=>[7229]},ssr:!1}),j=o()(()=>Promise.all([t.e(269),t.e(141)]).then(t.bind(t,3141)),{loadableGenerated:{webpack:()=>[3141]},loading:()=>(0,s.jsx)("p",{children:"Map is loading"}),ssr:!1});x.kL.register(x.uw,x.f$,x.ZL,x.qi,x.Dx,x.u,x.De);let v=new Date;v.setMonth(v.getMonth()-1);var f=()=>{let[e,a]=(0,l.useState)({startDate:v,endDate:new Date,key:"selection"}),[t,r]=(0,l.useState)(1),[o,x]=(0,l.useState)(""),[f,y]=(0,l.useState)([{name:"Series 1",data:[30,40,45,50,49,60,70,91,125]}]),[N,S]=(0,l.useState)({chart:{height:350,type:"line",zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight"},title:{text:"Grafico linel de emergencias",align:"left"},grid:{row:{colors:["#f3f3f3","transparent"],opacity:.5}},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep"]}}),[D,M]=(0,l.useState)(""),[A,k]=(0,l.useState)([]),[E,R]=(0,l.useState)(""),[C,O]=(0,l.useState)([]),[F,L]=(0,l.useState)(""),[P,I]=(0,l.useState)([]),[T,Z]=(0,l.useState)([]),[$,U]=(0,l.useState)(""),[_,B]=(0,l.useState)(""),[G,J]=(0,l.useState)(""),[X,z]=(0,l.useState)(""),[H,V]=(0,l.useState)(""),[W,q]=(0,l.useState)(0),[Q,Y]=(0,l.useState)(0),[K,ee]=(0,l.useState)(0),[ea,et]=(0,l.useState)(0),[es,el]=(0,l.useState)([{value:"1",label:"01:00 AM"},{value:"2",label:"02:00 AM"},{value:"3",label:"03:00 AM"},{value:"4",label:"04:00 AM"},{value:"5",label:"05:00 AM"},{value:"6",label:"06:00 AM"},{value:"7",label:"07:00 AM"},{value:"8",label:"08:00 AM"},{value:"9",label:"09:00 AM"},{value:"10",label:"10:00 AM"},{value:"11",label:"11:00 AM"},{value:"12",label:"12:00 PM"},{value:"13",label:"13:00 PM"},{value:"14",label:"14:00 PM"},{value:"15",label:"15:00 PM"},{value:"16",label:"16:00 PM"},{value:"17",label:"17:00 PM"},{value:"18",label:"18:00 PM"},{value:"19",label:"19:00 PM"},{value:"20",label:"20:00 PM"},{value:"21",label:"21:00 PM"},{value:"22",label:"22:00 PM"},{value:"23",label:"23:00 PM"},{value:"24",label:"24:00 PM"}]),[er,eo]=(0,l.useState)([]),[en,ei]=(0,l.useState)(!0),[ed,ec]=(0,l.useState)([25,15,44,55,41,17]),[eh,eu]=(0,l.useState)([]),em=e=>{let{titulo:a,descripcion:t,valor:l}=e;return(0,s.jsxs)("div",{className:"border border-gray-300 rounded-md p-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-blue-800",children:a}),(0,s.jsx)("p",{className:"text-gray-500",children:t}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("span",{className:"text-3xl font-bold text-blue-800",children:l})})]})};(0,l.useEffect)(()=>{ep()},[D,E,F,e.startDate,e.endDate,X.$d,H.$d]);let ep=async()=>{await ex(),await ew(D),await ev(D,E),await ef(D,E,F),await e$(),await eS(),ei(!1)},ex=()=>{b.Z.get("http://10.3.0.251:3000/api/reportes/obtenerCiudades").then(e=>{k(e.data.data),en&&M(e.data.data[0])}).catch(e=>{console.error(e)})},eb=async e=>{await M(e.target.value),await ew(D),await ev(D,E),await ef(D,E,$),await eS(),await R(""),await L("")},eg=async e=>{await R(e.target.value),await ev(D,E),await ef(D,E,$),await eS()},ew=e=>{b.Z.post("http://10.3.0.251:3000/api/reportes/obtenerBarrios",{ciudad:e}).then(e=>{O(e.data.data)}).catch(e=>{console.error(e)})},ej=async e=>{await L(e.target.value),await ef(D,E,$),await eS()},ev=(e,a)=>{b.Z.post("http://10.3.0.251:3000/api/reportes/obtenerEmergencias",{ciudad:e,barrio:a}).then(e=>{I(e.data.data)}).catch(e=>{console.error(e)})},ef=(e,a,t)=>{b.Z.post("http://10.3.0.251:3000/api/reportes/obtenerAnios",{ciudad:e,barrio:a,titulo:t}).then(e=>{Z(e.data.data)}).catch(e=>{console.error(e)})},ey=async e=>{await z(e),await eS()},eN=async e=>{await V(e),await eS()},eS=async()=>{await eZ(D,E,F,e.startDate,e.endDate,X.$d,H.$d),await eD(D,E,F,e.startDate,e.endDate,X.$d,H.$d),await eM(D,E,F,e.startDate,e.endDate,X.$d,H.$d),await eU(D,E,F,e.startDate,e.endDate,X.$d,H.$d)},eD=(e,a,t,s,l,r,o)=>{b.Z.post("http://10.3.0.251:3000/api/reportes/obtenerReporteBarras",{ciudad:e,barrio:a,titulo:t,fechaInicio:s,fechaFin:l,horaInicio:r,horaFin:o}).then(e=>{eo(e.data.data),console.log(e.data.data);let a=Object.keys(e.data.data),t=Object.values(e.data.data),s=a.map(e=>{let a=eA.find(a=>a.value===e);return a?a.label:null});y([{name:"Total de emergencias de este mes",data:t.map(e=>e)}]),S({chart:{height:350,type:"line",zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight"},title:{text:"Grafico linel de emergencias",align:"left"},grid:{row:{colors:["#f3f3f3","transparent"],opacity:.5}},xaxis:{categories:s}})}).catch(e=>{console.error(e)})},eM=(e,a,t,s,l,r,o)=>{b.Z.post("http://10.3.0.251:3000/api/reportes/obtenerReportePastel",{ciudad:e,barrio:a,titulo:t,fechaInicio:s,fechaFin:l,horaInicio:r,horaFin:o}).then(e=>{let a=Object.keys(e.data.data),t=Object.values(e.data.data);ec(t),eT({chart:{width:"100%",type:"heatmap",toolbar:{show:!0}},labels:a,theme:{monochrome:{enabled:!0}},plotOptions:{pie:{dataLabels:{offset:-5}}},title:{text:"Diagrama de pastel de emergencias"},dataLabels:{formatter:(e,a)=>(a.w.globals.labels[a.seriesIndex],[e.toFixed(1)+"%"])},legend:{show:!0}})}).catch(e=>{console.error(e)})},eA=[{value:"1",label:"Enero"},{value:"2",label:"Febrero"},{value:"3",label:"Marzo"},{value:"4",label:"Abril"},{value:"5",label:"Mayo"},{value:"6",label:"Junio"},{value:"7",label:"Julio"},{value:"8",label:"Agosto"},{value:"9",label:"Septiembre"},{value:"10",label:"Octubre"},{value:"11",label:"Noviembre"},{value:"12",label:"Diciembre"}],[ek,eE]=(0,l.useState)(10),[eR,eC]=(0,l.useState)([{titulo:1,position:[-1.197,-78.508]}]),[eO,eF]=(0,l.useState)([{name:"1",data:[10,2,30,40,5,60,70]},{name:"2",data:[0,0,0,0,0,0,10,2,30,40,5,60,70]},{name:"3",data:[0,0,0,0,0,0,10,0,0,0,30,40,5,60,70]},{name:"4",data:[0,0,0,0,0,0,10,20,0,0,0,40,50,60,70]},{name:"5",data:[[0,0,0,20,0,0,0,0,0,0,0,0,0]]},{name:"6",data:[[10,0,0,0,0,0,0,0,0,0]]},{name:"7",data:[[0,0,0,20,30,40,0,0,0,50,60,70]]}]),[eL,eP]=(0,l.useState)({chart:{type:"heatmap",toolbar:{show:!0}},plotOptions:{heatmap:{shadeIntensity:.5,colorScale:{ranges:[{from:1,to:30,name:"Bajo",color:"#008FFB"},{from:31,to:60,name:"Medio",color:"#efa94a"},{from:61,to:100,name:"Alto",color:"#FF4560"}]}}},xaxis:{categories:["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"]},dataLabels:{enabled:!1}}),[eI,eT]=(0,l.useState)({chart:{width:"100%",type:"heatmap",toolbar:{show:!0}},labels:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],theme:{monochrome:{enabled:!0}},plotOptions:{pie:{dataLabels:{offset:-5}}},title:{text:"Diagrama de pastel de emergencias"},dataLabels:{formatter:(e,a)=>(a.w.globals.labels[a.seriesIndex],[e.toFixed(1)+"%"])},legend:{show:!1}}),eZ=(e,a,t,s,l,r,o)=>{b.Z.post("http://10.3.0.251:3000/api/reportes/obtenerMapaCalor",{ciudad:e,barrio:a,titulo:t,fechaInicio:s,fechaFin:l,horaInicio:r,horaFin:o}).then(e=>{eF(e.data.data.heatmapData),eP({chart:{type:"heatmap",toolbar:{show:!0}},plotOptions:{heatmap:{shadeIntensity:.5,colorScale:{ranges:e.data.data.ranges}}},xaxis:{categories:["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"]},dataLabels:{enabled:!1}}),eE(e.data.data.total)}).catch(e=>{console.error(e)})},e$=()=>{b.Z.get("http://10.3.0.251:3000/api/reportes/obtenerDatosCards").then(e=>{q(e.data.data.publicacionesRegistradas),Y(e.data.data.usuariosRegistros),ee(e.data.data.publicacionesDelMes),et(e.data.data.publicacionesDelDia)}).catch(e=>{console.error(e)})},eU=(e,a,t,s,l,r,o)=>{b.Z.post("http://10.3.0.251:3000/api/reportes/obtenerCoordenadas",{ciudad:e,barrio:a,titulo:t,fechaInicio:s,fechaFin:l,horaInicio:r,horaFin:o}).then(e=>{eC(e.data.data)}).catch(e=>{console.error(e)})},[e_,eB]=(0,l.useState)(!1);function eG(e){return a=>e[a.label]?{...a,label:e[a.label]}:a}let eJ=d.defaultStaticRanges.map(eG({Today:"Hoy",Yesterday:"Ayer","This Week":"Esta semana","Last Week":"Semana pasada","This Month":"Este mes","Last Month":"Mes pasado"})),eX=d.defaultInputRanges.map(eG({"days up to today":"d\xedas hasta hoy","days starting today":"d\xedas a partir de hoy"}));return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(n.A,{title:"Reportes",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{className:"pt-28 pb-20 bg-white ",children:[(0,s.jsxs)("div",{className:"text-center fade-in",children:[(0,s.jsxs)("h1",{className:"title mb-4 text-3xl color-gray-light font-bold",children:["Anal\xedtica",(0,s.jsx)("br",{}),"Emergencias comunitarias"]}),(0,s.jsx)("br",{}),(0,s.jsx)("div",{className:" mx-auto px-32 ",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsx)(em,{titulo:"Usuarios registrados",descripcion:(0,s.jsxs)(s.Fragment,{children:["Total de usuarios registrados",(0,s.jsx)("br",{})," ",(0,s.jsx)("br",{})," ",(0,s.jsx)("br",{})]}),valor:Q}),(0,s.jsx)(em,{titulo:"Publicaciones registradas",descripcion:(0,s.jsxs)(s.Fragment,{children:["Total de publicaciones registradas",(0,s.jsx)("br",{})," ",(0,s.jsx)("br",{})]}),valor:W}),(0,s.jsx)(em,{titulo:"Publicaciones del mes",descripcion:"Total de publicaciones hechas en este mes",valor:K}),(0,s.jsx)(em,{titulo:"Publicaciones del d\xeda",descripcion:"Total de publicaciones hechas el d\xeda de hoy",valor:ea})]})}),(0,s.jsxs)("div",{className:"flex mt-4 justify-center gap-6 no-print",children:[(0,s.jsx)("button",{onClick:()=>{b.Z.post("http://10.3.0.251:3000/api/reportes/descargarPDF",{ciudad:D,barrio:E,titulo:F,fechaInicio:e.startDate,fechaFin:e.endDate,horaInicio:X.$d,horaFin:H.$d},{responseType:"blob"}).then(e=>{let a=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=a,t.setAttribute("download","datos.pdf"),document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a)}).catch(e=>{console.error("Error al descargar el archivo:",e)})},className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:scale-110 transition-all",children:(0,s.jsxs)("span",{className:"flex",children:[e_?"Descargando...":"Descargar PDF Datos",(0,s.jsx)(p.Z,{className:"h-5 w-5 ml-1 text-color-white"})]})}),(0,s.jsx)("button",{onClick:()=>{b.Z.post("http://10.3.0.251:3000/api/reportes/descargarCSV",{ciudad:D,barrio:E,titulo:F,fechaInicio:e.startDate,fechaFin:e.endDate,horaInicio:X.$d,horaFin:H.$d},{responseType:"blob"}).then(e=>{let a=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=a,t.setAttribute("download","datos.csv"),document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a)}).catch(e=>{console.error("Error al descargar el archivo CSV:",e)})},className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:scale-110 transition-all",children:(0,s.jsxs)("span",{className:"flex",children:["Descargar CSV",(0,s.jsx)(p.Z,{className:"h-5 w-5 ml-1 text-color-white"})]})}),(0,s.jsx)("button",{onClick:()=>{b.Z.post("http://10.3.0.251:3000/api/reportes/descargarXLSX",{ciudad:D,barrio:E,titulo:F,fechaInicio:e.startDate,fechaFin:e.endDate,horaInicio:X.$d,horaFin:H.$d},{responseType:"blob"}).then(e=>{let a=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=a,t.setAttribute("download","datos.xlsx"),document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a)}).catch(e=>{console.error("Error al descargar el archivo:",e)})},className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:scale-110 transition-all",children:(0,s.jsxs)("span",{className:"flex",children:["Descargar EXCEL",(0,s.jsx)(p.Z,{className:"h-5 w-5 ml-1 text-color-white"})]})})]})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)("section",{children:[(0,s.jsx)("div",{className:" px-32",children:(0,s.jsx)("div",{className:"text-sm font-medium  text-gray-500 border-gray-200 dark:text-gray-400 ",children:(0,s.jsx)("div",{className:"relative flex flex-w min-w-0 break-words bg-white w-full mb-6 shadow-lg rounded-lg",children:(0,s.jsx)("div",{className:"px-4 py-5 flex-auto",children:(0,s.jsxs)("div",{className:"flex flex-wrap",children:[(0,s.jsxs)("div",{className:"w-full  p-4 no-page-break",children:[(0,s.jsx)("h1",{className:"text-center",children:"Mapa de calor de publicaciones"}),(0,s.jsx)(w,{options:eL,series:eO,type:"heatmap",width:"100%"})]}),(0,s.jsxs)("div",{className:"w-full  p-4 no-page-break",children:[(0,s.jsx)("h1",{className:"text-center",children:"Ubicaci\xf3n exacta de las publicaciones"}),(0,s.jsx)(j,{coordinates:eR})]})]})})})})}),(0,s.jsx)("div",{className:" px-32 ",children:(0,s.jsx)("div",{className:"text-sm font-medium  text-gray-500 border-gray-200 dark:text-gray-400 ",children:(0,s.jsx)("div",{className:"relative flex flex-w min-w-0 break-words bg-white w-full mb-6 shadow-lg rounded-lg",children:(0,s.jsx)("div",{className:"px-4 py-5 flex-auto",children:(0,s.jsxs)("div",{className:"flex flex-wrap",children:[(0,s.jsx)("div",{className:"w-full  p-4 no-page-break",children:(0,s.jsx)(w,{options:N,series:f,type:"line",width:"100%"})}),(0,s.jsxs)("div",{className:"w-full  p-4 no-page-break",children:[(0,s.jsx)("h1",{className:"text-center",children:"Grafico de pastel"}),(0,s.jsx)(w,{options:eI,series:ed,type:"pie",width:"100%"})]})]})})})})})]})]}),(0,s.jsx)("div",{className:" sticky right-0 top-0 h-screen bg-white filtros shadow-lg no-print",children:(0,s.jsxs)("div",{className:"p-4 overflow-auto h-screen filtros",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Filtros"}),(0,s.jsxs)("div",{className:"sm:col-span-2 pt-5",children:[(0,s.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium leading-6 text-gray-900",children:"PARROQUIA"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)("select",{id:"country",name:"country",autoComplete:"country-name",value:D,onChange:eb,className:"w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600  sm:text-sm sm:leading-6",children:A.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium leading-6 text-gray-900",children:"ZONA/ BARRIO"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("select",{id:"country",name:"country",autoComplete:"country-name",value:E,onChange:eg,className:"w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600  sm:text-sm sm:leading-6",children:[(0,s.jsx)("option",{disabled:!0,children:"SELECCIONAR ZONA"}),(0,s.jsx)("option",{children:"TODAS"}),C.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium leading-6 text-gray-900",children:"TIPO DE EMERGENCIA"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("select",{id:"country",name:"country",autoComplete:"country-name",value:F,onChange:ej,className:"w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600  sm:text-sm sm:leading-6",children:[(0,s.jsx)("option",{disabled:!0,children:"SELECCIONAR TIPO DE EMERGENCIA"}),(0,s.jsx)("option",{value:"",children:"TODAS"},""),P.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium leading-6 text-gray-900",children:"RANGO DE D\xcdAS"}),(0,s.jsx)(g.Dw,{locale:i,staticRanges:eJ,inputRanges:eX,showSelectionPreview:!1,ranges:[e],onChange:e=>{e.selection?(console.log(void 0!=e.selection),a(e.selection)):a(e.range1),console.log(e.selection),console.log(e)}})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"hora",className:"block text-sm font-medium leading-6 text-gray-900",children:"HORA DE INICIO"}),(0,s.jsx)(h._,{dateAdapter:c.y,children:(0,s.jsx)(u.j,{className:"w-full",label:"Selecciona una hora",value:X,onChange:ey,viewRenderers:{hours:m.M6,minutes:m.M6,seconds:m.M6}})})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"hora",className:"block text-sm font-medium leading-6 text-gray-900",children:"HORA DE FIN"}),(0,s.jsx)(h._,{dateAdapter:c.y,children:(0,s.jsx)(u.j,{className:"w-full",label:"Selecciona una hora",value:H,onChange:eN,viewRenderers:{hours:m.M6,minutes:m.M6,seconds:m.M6}})})]}),(0,s.jsx)("div",{className:"sm:col-span-2",children:(0,s.jsxs)("label",{htmlFor:"hora",className:"block text-sm font-medium leading-6 text-gray-900",children:["TOTAL DE INCIDENTES OCURRIDOS:  ",ek]})})]})})]})})})}}},function(e){e.O(0,[196,61,505,530,981,921,774,888,179],function(){return e(e.s=9702)}),_N_E=e.O()}]);